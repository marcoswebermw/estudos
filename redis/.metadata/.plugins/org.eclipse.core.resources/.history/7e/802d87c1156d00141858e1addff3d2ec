package treinando;

import java.util.List;
import java.util.Set;

import redis.clients.jedis.Jedis;

public class ComandosBasicos2 {

	public static void main(String[] args) {
		armazenarValores();
		filtrarValores();
		obterMultiplosValores();
	}

	private static void armazenarValores() {
		String dataDoSorteio1 = "04-09-2013";
		String numerosDoSorteio1 = "10, 11, 18, 42, 55, 56";
		String chave1 = String.format("resultado:%s:megasena", dataDoSorteio1);
		String dataDoSorteio2 = "07-09-2013";
		String numerosDoSorteio2 = "2, 21, 30, 35, 45, 50";
		String chave2 = String.format("resultado:%s:megasena", dataDoSorteio2);
		String dataDoSorteio3 = "21-09-2013";
		String numerosDoSorteio3 = "2, 13, 24, 41, 42, 44";
		String chave3 = String.format("resultado:%s:megasena", dataDoSorteio3);
		String dataDoSorteio4 = "02-10-2013";
		String numerosDoSorteio4 = "7, 15, 20, 23, 30, 41";
		String chave4 = String.format("resultado:%s:megasena", dataDoSorteio4);
		Jedis jedis = new Jedis("localhost");
		String resultado = jedis.mset(chave1, numerosDoSorteio1, chave2,
				numerosDoSorteio2, chave3, numerosDoSorteio3, chave4,
				numerosDoSorteio4);
		System.out.println(resultado);
		jedis.close();
	}

	private static Set<String> filtrarResultados(int mes, int ano) {
		String chave = "resultado:*-%02d-%04d:megasena";
		Jedis jedis = new Jedis("localhost");
		Set<String> valores = jedis.keys(String.format(chave, mes, ano));
		jedis.close();
		return valores;
	}

	private static void filtrarValores() {
		int mes = 10;
		int ano = 2013;
		Set<String> chaves = filtrarResultados(mes, ano);
		System.out.println(chaves);
	}

//	private static void obterMultiplosValores() {
//		String chaves = "resultado:15-11-2014:megasena resultado:16-12-2014:megasena";
//		Jedis jedis = new Jedis("localhost");
//		List<String> resultado = jedis.mget("resultado:15-11-2014:megasena", "resultado:16-12-2014:megasena");
//		System.out.println(resultado);
//		jedis.close();
//	}
	
	private static void obterMultiplosValores() {
		String chaves = "resultado:15-11-2014:megasena resultado:16-12-2014:megasena";
		Jedis jedis = new Jedis("localhost");
		List<String> resultado = jedis.mget("resultado:15-11-2014:megasena", "resultado:16-12-2014:megasena");
		imprimirLista(resultado);		
		jedis.close();
	}

	private static void imprimirLista(List<String> resultado) {
		for(int i=0; i >= resultado.size();i++){
			System.out.println(resultado.get(i).toString());
		}
	}
	

}
